<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="uni.miskolc.ips.ilona.tracking.persist.mappers.TrackingLoginMapper">
     


	
	
	
	<!--  Selects -->
	
	<select id="selectPositionById" resultMap="PositionResultMap" parameterType="String">
		select * from Position p inner join Zone z on z.zoneId = p.zoneId 
		where p.posId like #{id};
	</select>
	
	<select id="selectBTTagsForMeasurement" resultType="String" parameterType="String">
	    select btDeviceId from BluetoothTags where measId = #{measId};
	</select>
	
	 
	<select id="selectWiFiRSSIForMeasurement" resultType="HashMap" parameterType="String">
	    select ssid, rssi from WIFIRSSI where measId = #{measId};
	</select>
	
	
	
	<select id="selectRFIDTagsForMeasurement" resultType="_byte[]" parameterType="String">
	    select rfidTag from RFIDTags where measId = #{measId};
	</select>
	
	
	<!-- TODO RFID Tags -->
	<!-- 
	<select id="selectRFIDTagsForMeasurement" resultType="byte" parameterType="String">
	    select rfidTag from RFIDTags where measId = #{measId};
	</select>
	 -->
	<select id="selectMeasurements" resultMap="MeasurementResultMap">
	    select * from Measurement;
	</select>
	
	<!-- TODO -->
	
	<insert id="insertMeasurement">
		insert into Measurement values(
		#{id, typeHandler=UUIDTypeHandler, jdbcType=VARCHAR},
		#{timestamp},
		#{magnetometer.xAxis},
		#{magnetometer.yAxis},
		#{magnetometer.zAxis},
		#{magnetometer.radian},
		#{gpsCoordinates.latitude},
		#{gpsCoordinates.longitude},
		#{gpsCoordinates.altitude},
		#{position.id, typeHandler=UUIDTypeHandler, jdbcType=VARCHAR}
		);
	</insert>
	
	<insert id="insertWiFiRSSI4Measurement">
		insert into WIFIRSSI values (
			#{ssid},
			#{rssi},
			#{measId}
		);
	</insert>
	
	<insert id="insertBTDevice4Measurement">
	insert into BluetoothTags values (
		#{btDeviceId},
		#{measId}	
	);
	</insert>


 	<delete id="deleteMeasurementByMeasurement" parameterType="String">
		delete from Measurement where measId = #{measId};
	</delete>
	
	<delete id ="deleteMeasurementByTimestamp" parameterType="Date">
		delete from Measurement where measTimestamp = #{stamp};
	</delete>
</mapper>